<!DOCTYPE html>
<html>
<head>
    <title>Mapbox GL JS Example</title>
    <meta charset='utf-8' />
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: Arial, sans-serif; 
        }
        #map { 
            position: absolute; 
            right: 0; 
            top: 0; 
            bottom: 0; 
            width: 75%; 
        }
        #controls { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            left: 0; 
            width: 25%; 
            z-index: 9999; 
            background-color: #ffffff; 
            padding: 20px; 
            overflow-y: auto; 
            box-shadow: 2px 0px 6px rgba(0, 0, 0, 0.1); 
            border-right: 1px solid #ddd;
        }
        .collapsible {
            background-color: transparent;
            color: #333;
            cursor: pointer;
            padding: 18px;
            border: none;
            text-align: left;
            outline: none;
            font-size: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content {
            padding: 0 18px;
            display: block;
            overflow: hidden;
            background-color: #ffffff;
            margin-bottom: 32px;
        }

        .content label {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .content label input[type='checkbox'] {
            appearance: none;
            background-color: #ffffff;
            border: 1px solid #cacece;
            padding: 9px;
            margin-right: 8px;
            border-radius: 3px;
            display: inline-block;
            position: relative;
        }

        .content label input[type='checkbox']:checked:after {
            content: '\2714';
            font-size: 14px;
            position: absolute;
            top: 0px;
            left: 3px;
            color: #1ed760;
        }

        .content label input[type='checkbox']:checked {
            background-color: #ffffff;
            color: #57a3ee;
        }

        .collapsible .toggle-icon {
            margin-left: 5px;
            font-size: 32px; /* Increase icon size */
        }

        .collapsible .toggle-icon::before {
            content: "";
            position: absolute;
            width: 32px;  /* Adjust to the desired circle size */
            height: 32px; /* Adjust to the desired circle size */
            border: 1px solid #cacece; /* Same border color as checkbox */
            border-radius: 50%; /* Makes it a circle */
            z-index: -1; /* Puts it behind the '+' or '-' symbol */
            left: 50%; /* Center the circle horizontally */
            top: 50%; /* Center the circle vertically */
            transform: translate(-50%, -50%); /* Necessary for accurate centering */
        }

    </style>
    
</head>
<body>

<div id="map"></div>
<div id="controls">
    <a href="https://www.sg.gs/" target="_blank" style="display: inline-block; padding: 18px;">
        <img src="https://uploads-ssl.webflow.com/6453980466edcb7b60b5acc6/645d24d0a232c66610f0851f_Logo%20(1).svg" alt="Logo" style="width: 100px; height: auto;">
    </a>
    <div class="collapsible">
        PoPs
        <span class="toggle-icon">-</span>
    </div>
    <div class="content" id="group1">
        <label>
            <input type="checkbox" id="controlUS_Sites" checked>
            US_Sites
        </label>
        <label>
            <input type="checkbox" id="controlEurope_Sites" checked>
            Europe_Sites
        </label>
        <label>
            <input type="checkbox" id="controlAsia_Sites" checked>
            Asia_Sites
        </label>
    </div>

    <div class="collapsible">
        Fiber Cables
        <span class="toggle-icon">-</span>
    </div>
    <div class="content" id="group2">
        <label>
            <input type="checkbox" id="controlUS" checked>
            US
        </label>
        <label>
            <input type="checkbox" id="controlEurope" checked>
            Europe
        </label>
        <label>
            <input type="checkbox" id="controlAsia" checked>
            Asia
        </label>
        <label>
            <input type="checkbox" id="controlTranspacific" checked>
            Transpacific
        </label>
    </div>
</div>


<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoianVsaWFuLXJhZGlhbCIsImEiOiJjbGk0ZGlkMmYycWp4M3FudGgwbHJwbXNzIn0.UzaN1847nScw6rPqMf-Siw';

    var colors = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf", "#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd"];
    
    var mapFiles = ['US', 'US_Sites', 'Europe', 'Europe_Sites', 'Asia', 'Asia_Sites', 'Transpacific'];

    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/dark-v10',
        center: [0, 0],
        zoom: 1
    });

    map.on('load', function () {
        for (let i = 0; i < mapFiles.length; i++) {
            addLayersAndControls(mapFiles[i], `group${i%3+1}`);
        }
    });

    function addLayersAndControls(filename, groupId) {
        map.addSource(filename, {
            'type': 'geojson',
            'data': `./${filename}.geojson`
        });
        map.addLayer({
            'id': filename,
            'type': 'line',
            'source': filename,
            'paint': {
                'line-color': colors[mapFiles.indexOf(filename) % colors.length],
                'line-width': 2
            }
        });

        var checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = `control${filename}`;
        checkbox.checked = true;
        checkbox.onchange = function () {
            var id = this.id.replace('control', '');
            var visibility = map.getLayoutProperty(id, 'visibility');
            if (visibility === 'visible') {
                map.setLayoutProperty(id, 'visibility', 'none');
            } else {
                map.setLayoutProperty(id, 'visibility', 'visible');
            }
        };
        var label = document.createElement('label');
        label.htmlFor = `control${filename}`;
        label.textContent = filename;
        label.insertBefore(checkbox, label.firstChild);

        var controlDiv = document.getElementById(groupId);
        controlDiv.appendChild(label);
    }

    var coll = document.getElementsByClassName("collapsible");
    var i;
    
    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.display === "block") {
          content.style.display = "none";
          this.querySelector('.toggle-icon').textContent = '+';
        } else {
          content.style.display = "block";
          this.querySelector('.toggle-icon').textContent = '-';
        }
      });
    }
</script>
</body>
</html>
